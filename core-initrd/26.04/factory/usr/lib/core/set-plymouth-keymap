#!/bin/sh

set -eu

# Keymap has the structure layout,model,variant,options
xkb_list="$(/usr/libexec/core/get-arg snapd.xkb || true)"

[ -z "$xkb_list" ] && exit 0

IFS=','; set -- $xkb_list

layout="${1:-}"
model="${2:-}"
variant="${3:-}"
options="${4:-}"

cat << EOF > /etc/default/keyboard
# KEYBOARD CONFIGURATION FILE
# THIS FILE WAS AUTOMATICALLY CREATED
# BY THE "snapd.xkb" KERNEL ARGUMENT

XKBMODEL="$model"
XKBLAYOUT="$layout"
XKBVARIANT="$variant"
XKBOPTIONS="$options"

BACKSPACE="guess"
EOF
