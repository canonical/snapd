// -*- Mode: Go; indent-tabs-mode: t -*-

/*
 * Copyright (C) 2014-2020 Canonical Ltd
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License version 3 as
 * published by the Free Software Foundation.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 *
 */

package quantity_test

import (
	"fmt"
	"math"
	"testing"
	"time"

	. "gopkg.in/check.v1"

	"github.com/snapcore/snapd/strutil/quantity"
)

func Test(t *testing.T) { TestingT(t) }

type quantitySuite struct{}

var _ = Suite(&quantitySuite{})

var dataset = []float64{
	-math.MaxFloat64,
	float64(math.MinInt64),
	-time.Duration(3 * time.Nanosecond).Seconds(),
	time.Duration(3 * time.Nanosecond).Seconds(),
	time.Duration(36 * time.Microsecond).Seconds(),
	time.Duration(36*time.Microsecond + 3*time.Nanosecond).Seconds(),
	time.Duration(420*time.Millisecond + 36*time.Microsecond + 3*time.Nanosecond).Seconds(),
	time.Duration(430 * time.Millisecond).Seconds(),
	time.Duration(5155 * time.Millisecond).Seconds(),
	time.Duration(time.Minute + 2*time.Second).Seconds(),
	time.Duration(124 * time.Minute / 10).Seconds(),
	time.Duration(2*time.Hour + 29*time.Minute).Seconds(),
	time.Duration(10*time.Hour + 9*time.Minute).Seconds(),
	time.Duration(10*time.Hour + 30*time.Minute).Seconds(),
	time.Duration(10*time.Hour + 30*time.Minute + 2*time.Second).Seconds(),
	time.Duration(11*time.Hour + 2*time.Minute).Seconds(),
	time.Duration(22*time.Hour + 59*time.Minute + 59*time.Second).Seconds(),
	time.Duration(23*time.Hour + 59*time.Minute + 59*time.Second).Seconds(),
	time.Duration(30 * time.Hour).Seconds(),
	time.Duration(345 * time.Hour).Seconds(),
	time.Duration(357 * time.Hour).Seconds(),
	time.Duration(4272 * time.Hour).Seconds(),
	time.Duration(4273*time.Hour + 30*time.Minute + 2*time.Second).Seconds(),
	time.Duration(51368 * time.Hour).Seconds(),
	time.Duration(math.MaxInt64 / 10).Seconds(),
	time.Duration(math.MaxInt64).Seconds() - time.Duration(quantity.Year).Seconds(),
	float64(math.MaxUint64) * 365 * 24 * 60 * 60,
	math.MaxFloat64,
}

var tests = []struct {
	min     time.Duration
	max     time.Duration
	count   quantity.Places
	render  quantity.RenderMode
	space   quantity.SpaceMode
	results []string
}{
	{
		time.Nanosecond,
		quantity.Year,
		quantity.ShowVerbose,
		quantity.TimeLeft,
		quantity.SpaceOn,
		[]string{
			"0ns",
			"0ns",
			"0ns",
			"3ns",
			"36µs",
			"36.003µs",
			"420.036003ms",
			"430ms",
			"5.155000000s",
			"1m 2s",
			"12m 24s",
			"2h 29m",
			"10h 9m",
			"10h 30m",
			"10h 30m 2s",
			"11h 2m",
			"22h 59m 59s",
			"23h 59m 59s",
			"1d 6h",
			"14d 9h",
			"14d 21h",
			"178d",
			"178d 1h 30m 2s",
			"5y 314d 2h",
			"29y 82d 22h 46m 43.685477632s",
			"291y 98d 23h 47m 16.854776832s",
			"ages!",
			"ages!",
		},
	},
	{
		time.Nanosecond,
		quantity.Day,
		quantity.ShowVerbose,
		quantity.TimeLeft,
		quantity.SpaceOn,
		[]string{
			"0ns",
			"0ns",
			"0ns",
			"3ns",
			"36µs",
			"36.003µs",
			"420.036003ms",
			"430ms",
			"5.155000000s",
			"1m 2s",
			"12m 24s",
			"2h 29m",
			"10h 9m",
			"10h 30m",
			"10h 30m 2s",
			"11h 2m",
			"22h 59m 59s",
			"23h 59m 59s",
			"1d 6h",
			"14d 9h",
			"14d 21h",
			"178d",
			"178d 1h 30m 2s",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
		},
	},
	{
		time.Nanosecond,
		time.Hour,
		quantity.ShowVerbose,
		quantity.TimeLeft,
		quantity.SpaceOn,
		[]string{
			"0ns",
			"0ns",
			"0ns",
			"3ns",
			"36µs",
			"36.003µs",
			"420.036003ms",
			"430ms",
			"5.155000000s",
			"1m 2s",
			"12m 24s",
			"2h 29m",
			"10h 9m",
			"10h 30m",
			"10h 30m 2s",
			"11h 2m",
			"22h 59m 59s",
			"23h 59m 59s",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
		},
	},
	{
		time.Nanosecond,
		time.Minute,
		quantity.ShowVerbose,
		quantity.TimeLeft,
		quantity.SpaceOn,
		[]string{
			"0ns",
			"0ns",
			"0ns",
			"3ns",
			"36µs",
			"36.003µs",
			"420.036003ms",
			"430ms",
			"5.155000000s",
			"1m 2s",
			"12m 24s",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
		},
	},
	{
		time.Nanosecond,
		time.Second,
		quantity.ShowVerbose,
		quantity.TimeLeft,
		quantity.SpaceOn,
		[]string{
			"0ns",
			"0ns",
			"0ns",
			"3ns",
			"36µs",
			"36.003µs",
			"420.036003ms",
			"430ms",
			"5.155000000s",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
		},
	},
	{
		time.Nanosecond,
		time.Nanosecond,
		quantity.ShowVerbose,
		quantity.TimeLeft,
		quantity.SpaceOn,
		[]string{
			"0ns",
			"0ns",
			"0ns",
			"3ns",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
		},
	},
	{
		time.Microsecond,
		quantity.Year,
		quantity.ShowVerbose,
		quantity.TimeLeft,
		quantity.SpaceOn,
		[]string{
			"0µs",
			"0µs",
			"0µs",
			"1µs",
			"36µs",
			"37µs",
			"420.037ms",
			"430ms",
			"5.155000s",
			"1m 2s",
			"12m 24s",
			"2h 29m",
			"10h 9m",
			"10h 30m",
			"10h 30m 2s",
			"11h 2m",
			"22h 59m 59s",
			"23h 59m 59s",
			"1d 6h",
			"14d 9h",
			"14d 21h",
			"178d",
			"178d 1h 30m 2s",
			"5y 314d 2h",
			"29y 82d 22h 46m 43.685478s",
			"291y 98d 23h 47m 16.854777s",
			"ages!",
			"ages!",
		},
	},
	{
		time.Millisecond,
		quantity.Year,
		quantity.ShowVerbose,
		quantity.TimeLeft,
		quantity.SpaceOn,
		[]string{
			"0ms",
			"0ms",
			"0ms",
			"1ms",
			"1ms",
			"1ms",
			"421ms",
			"430ms",
			"5.155s",
			"1m 2s",
			"12m 24s",
			"2h 29m",
			"10h 9m",
			"10h 30m",
			"10h 30m 2s",
			"11h 2m",
			"22h 59m 59s",
			"23h 59m 59s",
			"1d 6h",
			"14d 9h",
			"14d 21h",
			"178d",
			"178d 1h 30m 2s",
			"5y 314d 2h",
			"29y 82d 22h 46m 43.686s",
			"291y 98d 23h 47m 16.855s",
			"ages!",
			"ages!",
		},
	},
	{
		time.Second,
		quantity.Year,
		quantity.ShowVerbose,
		quantity.TimeLeft,
		quantity.SpaceOn,
		[]string{
			"0s",
			"0s",
			"0s",
			"1s",
			"1s",
			"1s",
			"1s",
			"1s",
			"6s",
			"1m 2s",
			"12m 24s",
			"2h 29m",
			"10h 9m",
			"10h 30m",
			"10h 30m 2s",
			"11h 2m",
			"22h 59m 59s",
			"23h 59m 59s",
			"1d 6h",
			"14d 9h",
			"14d 21h",
			"178d",
			"178d 1h 30m 2s",
			"5y 314d 2h",
			"29y 82d 22h 46m 44s",
			"291y 98d 23h 47m 17s",
			"ages!",
			"ages!",
		},
	},
	{
		time.Minute,
		quantity.Year,
		quantity.ShowVerbose,
		quantity.TimeLeft,
		quantity.SpaceOn,
		[]string{
			"0m",
			"0m",
			"0m",
			"1m",
			"1m",
			"1m",
			"1m",
			"1m",
			"1m",
			"2m",
			"13m",
			"2h 29m",
			"10h 9m",
			"10h 30m",
			"10h 31m",
			"11h 2m",
			"23h",
			"1d",
			"1d 6h",
			"14d 9h",
			"14d 21h",
			"178d",
			"178d 1h 31m",
			"5y 314d 2h",
			"29y 82d 22h 47m",
			"291y 98d 23h 48m",
			"ages!",
			"ages!",
		},
	},
	{
		time.Hour,
		quantity.Year,
		quantity.ShowVerbose,
		quantity.TimeLeft,
		quantity.SpaceOn,
		[]string{
			"0h",
			"0h",
			"0h",
			"1h",
			"1h",
			"1h",
			"1h",
			"1h",
			"1h",
			"1h",
			"1h",
			"3h",
			"11h",
			"11h",
			"11h",
			"12h",
			"23h",
			"1d",
			"1d 6h",
			"14d 9h",
			"14d 21h",
			"178d",
			"178d 2h",
			"5y 314d 2h",
			"29y 82d 23h",
			"291y 99d",
			"ages!",
			"ages!",
		},
	},
	{
		quantity.Day,
		quantity.Year,
		quantity.ShowVerbose,
		quantity.TimeLeft,
		quantity.SpaceOn,
		[]string{
			"0d",
			"0d",
			"0d",
			"1d",
			"1d",
			"1d",
			"1d",
			"1d",
			"1d",
			"1d",
			"1d",
			"1d",
			"1d",
			"1d",
			"1d",
			"1d",
			"1d",
			"1d",
			"2d",
			"15d",
			"15d",
			"178d",
			"179d",
			"5y 314d",
			"29y 83d",
			"291y 99d",
			"ages!",
			"ages!",
		},
	},
	{
		quantity.Year,
		quantity.Year,
		quantity.ShowVerbose,
		quantity.TimeLeft,
		quantity.SpaceOn,
		[]string{
			"0y",
			"0y",
			"0y",
			"1y",
			"1y",
			"1y",
			"1y",
			"1y",
			"1y",
			"1y",
			"1y",
			"1y",
			"1y",
			"1y",
			"1y",
			"1y",
			"1y",
			"1y",
			"1y",
			"1y",
			"1y",
			"1y",
			"1y",
			"6y",
			"30y",
			"292y",
			"ages!",
			"ages!",
		},
	},
	{
		time.Second,
		time.Hour,
		quantity.ShowVerbose,
		quantity.TimeLeft,
		quantity.SpaceOn,
		[]string{
			"0s",
			"0s",
			"0s",
			"1s",
			"1s",
			"1s",
			"1s",
			"1s",
			"6s",
			"1m 2s",
			"12m 24s",
			"2h 29m",
			"10h 9m",
			"10h 30m",
			"10h 30m 2s",
			"11h 2m",
			"22h 59m 59s",
			"23h 59m 59s",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
		},
	},
	{
		time.Nanosecond,
		quantity.Year,
		quantity.ShowCompact,
		quantity.TimeLeft,
		quantity.SpaceOn,
		[]string{
			"0ns",
			"0ns",
			"0ns",
			"3ns",
			"36µs",
			"37µs",
			"421ms",
			"430ms",
			"6s",
			"1m 2s",
			"12m 24s",
			"2h 29m",
			"10h 9m",
			"10h 30m",
			"10h 31m",
			"11h 2m",
			"23h",
			"1d",
			"1d 6h",
			"14d 9h",
			"14d 21h",
			"178d",
			"179d",
			"6y",
			"30y",
			"292y",
			"ages!",
			"ages!",
		},
	},
	{
		time.Nanosecond,
		quantity.Day,
		quantity.ShowCompact,
		quantity.TimeLeft,
		quantity.SpaceOn,
		[]string{
			"0ns",
			"0ns",
			"0ns",
			"3ns",
			"36µs",
			"37µs",
			"421ms",
			"430ms",
			"6s",
			"1m 2s",
			"12m 24s",
			"2h 29m",
			"10h 9m",
			"10h 30m",
			"10h 31m",
			"11h 2m",
			"23h",
			"1d",
			"1d 6h",
			"14d 9h",
			"14d 21h",
			"178d",
			"179d",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
		},
	},
	{
		time.Nanosecond,
		time.Hour,
		quantity.ShowCompact,
		quantity.TimeLeft,
		quantity.SpaceOn,
		[]string{
			"0ns",
			"0ns",
			"0ns",
			"3ns",
			"36µs",
			"37µs",
			"421ms",
			"430ms",
			"6s",
			"1m 2s",
			"12m 24s",
			"2h 29m",
			"10h 9m",
			"10h 30m",
			"10h 31m",
			"11h 2m",
			"23h",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
		},
	},
	{
		time.Nanosecond,
		time.Minute,
		quantity.ShowCompact,
		quantity.TimeLeft,
		quantity.SpaceOn,
		[]string{
			"0ns",
			"0ns",
			"0ns",
			"3ns",
			"36µs",
			"37µs",
			"421ms",
			"430ms",
			"6s",
			"1m 2s",
			"12m 24s",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
		},
	},
	{
		time.Nanosecond,
		time.Second,
		quantity.ShowCompact,
		quantity.TimeLeft,
		quantity.SpaceOn,
		[]string{
			"0ns",
			"0ns",
			"0ns",
			"3ns",
			"36µs",
			"37µs",
			"421ms",
			"430ms",
			"6s",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
		},
	},
	{
		time.Nanosecond,
		time.Nanosecond,
		quantity.ShowCompact,
		quantity.TimeLeft,
		quantity.SpaceOn,
		[]string{
			"0ns",
			"0ns",
			"0ns",
			"3ns",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
		},
	},
	{
		time.Microsecond,
		quantity.Year,
		quantity.ShowCompact,
		quantity.TimeLeft,
		quantity.SpaceOn,
		[]string{
			"0µs",
			"0µs",
			"0µs",
			"1µs",
			"36µs",
			"37µs",
			"421ms",
			"430ms",
			"6s",
			"1m 2s",
			"12m 24s",
			"2h 29m",
			"10h 9m",
			"10h 30m",
			"10h 31m",
			"11h 2m",
			"23h",
			"1d",
			"1d 6h",
			"14d 9h",
			"14d 21h",
			"178d",
			"179d",
			"6y",
			"30y",
			"292y",
			"ages!",
			"ages!",
		},
	},
	{
		time.Millisecond,
		quantity.Year,
		quantity.ShowCompact,
		quantity.TimeLeft,
		quantity.SpaceOn,
		[]string{
			"0ms",
			"0ms",
			"0ms",
			"1ms",
			"1ms",
			"1ms",
			"421ms",
			"430ms",
			"6s",
			"1m 2s",
			"12m 24s",
			"2h 29m",
			"10h 9m",
			"10h 30m",
			"10h 31m",
			"11h 2m",
			"23h",
			"1d",
			"1d 6h",
			"14d 9h",
			"14d 21h",
			"178d",
			"179d",
			"6y",
			"30y",
			"292y",
			"ages!",
			"ages!",
		},
	},
	{
		time.Second,
		quantity.Year,
		quantity.ShowCompact,
		quantity.TimeLeft,
		quantity.SpaceOn,
		[]string{
			"0s",
			"0s",
			"0s",
			"1s",
			"1s",
			"1s",
			"1s",
			"1s",
			"6s",
			"1m 2s",
			"12m 24s",
			"2h 29m",
			"10h 9m",
			"10h 30m",
			"10h 31m",
			"11h 2m",
			"23h",
			"1d",
			"1d 6h",
			"14d 9h",
			"14d 21h",
			"178d",
			"179d",
			"6y",
			"30y",
			"292y",
			"ages!",
			"ages!",
		},
	},
	{
		time.Minute,
		quantity.Year,
		quantity.ShowCompact,
		quantity.TimeLeft,
		quantity.SpaceOn,
		[]string{
			"0m",
			"0m",
			"0m",
			"1m",
			"1m",
			"1m",
			"1m",
			"1m",
			"1m",
			"2m",
			"13m",
			"2h 29m",
			"10h 9m",
			"10h 30m",
			"10h 31m",
			"11h 2m",
			"23h",
			"1d",
			"1d 6h",
			"14d 9h",
			"14d 21h",
			"178d",
			"179d",
			"6y",
			"30y",
			"292y",
			"ages!",
			"ages!",
		},
	},
	{
		time.Hour,
		quantity.Year,
		quantity.ShowCompact,
		quantity.TimeLeft,
		quantity.SpaceOn,
		[]string{
			"0h",
			"0h",
			"0h",
			"1h",
			"1h",
			"1h",
			"1h",
			"1h",
			"1h",
			"1h",
			"1h",
			"3h",
			"11h",
			"11h",
			"11h",
			"12h",
			"23h",
			"1d",
			"1d 6h",
			"14d 9h",
			"14d 21h",
			"178d",
			"179d",
			"6y",
			"30y",
			"292y",
			"ages!",
			"ages!",
		},
	},
	{
		quantity.Day,
		quantity.Year,
		quantity.ShowCompact,
		quantity.TimeLeft,
		quantity.SpaceOn,
		[]string{
			"0d",
			"0d",
			"0d",
			"1d",
			"1d",
			"1d",
			"1d",
			"1d",
			"1d",
			"1d",
			"1d",
			"1d",
			"1d",
			"1d",
			"1d",
			"1d",
			"1d",
			"1d",
			"2d",
			"15d",
			"15d",
			"178d",
			"179d",
			"6y",
			"30y",
			"292y",
			"ages!",
			"ages!",
		},
	},
	{
		quantity.Year,
		quantity.Year,
		quantity.ShowCompact,
		quantity.TimeLeft,
		quantity.SpaceOn,
		[]string{
			"0y",
			"0y",
			"0y",
			"1y",
			"1y",
			"1y",
			"1y",
			"1y",
			"1y",
			"1y",
			"1y",
			"1y",
			"1y",
			"1y",
			"1y",
			"1y",
			"1y",
			"1y",
			"1y",
			"1y",
			"1y",
			"1y",
			"1y",
			"6y",
			"30y",
			"292y",
			"ages!",
			"ages!",
		},
	},
	{
		time.Second,
		time.Hour,
		quantity.ShowCompact,
		quantity.TimeLeft,
		quantity.SpaceOn,
		[]string{
			"0s",
			"0s",
			"0s",
			"1s",
			"1s",
			"1s",
			"1s",
			"1s",
			"6s",
			"1m 2s",
			"12m 24s",
			"2h 29m",
			"10h 9m",
			"10h 30m",
			"10h 31m",
			"11h 2m",
			"23h",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
		},
	},
	{
		time.Nanosecond,
		quantity.Year,
		quantity.ShowVerbose,
		quantity.TimeLeft,
		quantity.SpaceOff,
		[]string{
			"0ns",
			"0ns",
			"0ns",
			"3ns",
			"36µs",
			"36.003µs",
			"420.036003ms",
			"430ms",
			"5.155000000s",
			"1m2s",
			"12m24s",
			"2h29m",
			"10h9m",
			"10h30m",
			"10h30m2s",
			"11h2m",
			"22h59m59s",
			"23h59m59s",
			"1d6h",
			"14d9h",
			"14d21h",
			"178d",
			"178d1h30m2s",
			"5y314d2h",
			"29y82d22h46m43.685477632s",
			"291y98d23h47m16.854776832s",
			"ages!",
			"ages!",
		},
	},
	{
		time.Nanosecond,
		quantity.Day,
		quantity.ShowVerbose,
		quantity.TimeLeft,
		quantity.SpaceOff,
		[]string{
			"0ns",
			"0ns",
			"0ns",
			"3ns",
			"36µs",
			"36.003µs",
			"420.036003ms",
			"430ms",
			"5.155000000s",
			"1m2s",
			"12m24s",
			"2h29m",
			"10h9m",
			"10h30m",
			"10h30m2s",
			"11h2m",
			"22h59m59s",
			"23h59m59s",
			"1d6h",
			"14d9h",
			"14d21h",
			"178d",
			"178d1h30m2s",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
		},
	},
	{
		time.Nanosecond,
		time.Hour,
		quantity.ShowVerbose,
		quantity.TimeLeft,
		quantity.SpaceOff,
		[]string{
			"0ns",
			"0ns",
			"0ns",
			"3ns",
			"36µs",
			"36.003µs",
			"420.036003ms",
			"430ms",
			"5.155000000s",
			"1m2s",
			"12m24s",
			"2h29m",
			"10h9m",
			"10h30m",
			"10h30m2s",
			"11h2m",
			"22h59m59s",
			"23h59m59s",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
		},
	},
	{
		time.Nanosecond,
		time.Minute,
		quantity.ShowVerbose,
		quantity.TimeLeft,
		quantity.SpaceOff,
		[]string{
			"0ns",
			"0ns",
			"0ns",
			"3ns",
			"36µs",
			"36.003µs",
			"420.036003ms",
			"430ms",
			"5.155000000s",
			"1m2s",
			"12m24s",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
		},
	},
	{
		time.Nanosecond,
		time.Second,
		quantity.ShowVerbose,
		quantity.TimeLeft,
		quantity.SpaceOff,
		[]string{
			"0ns",
			"0ns",
			"0ns",
			"3ns",
			"36µs",
			"36.003µs",
			"420.036003ms",
			"430ms",
			"5.155000000s",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
		},
	},
	{
		time.Nanosecond,
		time.Nanosecond,
		quantity.ShowVerbose,
		quantity.TimeLeft,
		quantity.SpaceOff,
		[]string{
			"0ns",
			"0ns",
			"0ns",
			"3ns",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
		},
	},
	{
		time.Microsecond,
		quantity.Year,
		quantity.ShowVerbose,
		quantity.TimeLeft,
		quantity.SpaceOff,
		[]string{
			"0µs",
			"0µs",
			"0µs",
			"1µs",
			"36µs",
			"37µs",
			"420.037ms",
			"430ms",
			"5.155000s",
			"1m2s",
			"12m24s",
			"2h29m",
			"10h9m",
			"10h30m",
			"10h30m2s",
			"11h2m",
			"22h59m59s",
			"23h59m59s",
			"1d6h",
			"14d9h",
			"14d21h",
			"178d",
			"178d1h30m2s",
			"5y314d2h",
			"29y82d22h46m43.685478s",
			"291y98d23h47m16.854777s",
			"ages!",
			"ages!",
		},
	},
	{
		time.Millisecond,
		quantity.Year,
		quantity.ShowVerbose,
		quantity.TimeLeft,
		quantity.SpaceOff,
		[]string{
			"0ms",
			"0ms",
			"0ms",
			"1ms",
			"1ms",
			"1ms",
			"421ms",
			"430ms",
			"5.155s",
			"1m2s",
			"12m24s",
			"2h29m",
			"10h9m",
			"10h30m",
			"10h30m2s",
			"11h2m",
			"22h59m59s",
			"23h59m59s",
			"1d6h",
			"14d9h",
			"14d21h",
			"178d",
			"178d1h30m2s",
			"5y314d2h",
			"29y82d22h46m43.686s",
			"291y98d23h47m16.855s",
			"ages!",
			"ages!",
		},
	},
	{
		time.Second,
		quantity.Year,
		quantity.ShowVerbose,
		quantity.TimeLeft,
		quantity.SpaceOff,
		[]string{
			"0s",
			"0s",
			"0s",
			"1s",
			"1s",
			"1s",
			"1s",
			"1s",
			"6s",
			"1m2s",
			"12m24s",
			"2h29m",
			"10h9m",
			"10h30m",
			"10h30m2s",
			"11h2m",
			"22h59m59s",
			"23h59m59s",
			"1d6h",
			"14d9h",
			"14d21h",
			"178d",
			"178d1h30m2s",
			"5y314d2h",
			"29y82d22h46m44s",
			"291y98d23h47m17s",
			"ages!",
			"ages!",
		},
	},
	{
		time.Minute,
		quantity.Year,
		quantity.ShowVerbose,
		quantity.TimeLeft,
		quantity.SpaceOff,
		[]string{
			"0m",
			"0m",
			"0m",
			"1m",
			"1m",
			"1m",
			"1m",
			"1m",
			"1m",
			"2m",
			"13m",
			"2h29m",
			"10h9m",
			"10h30m",
			"10h31m",
			"11h2m",
			"23h",
			"1d",
			"1d6h",
			"14d9h",
			"14d21h",
			"178d",
			"178d1h31m",
			"5y314d2h",
			"29y82d22h47m",
			"291y98d23h48m",
			"ages!",
			"ages!",
		},
	},
	{
		time.Hour,
		quantity.Year,
		quantity.ShowVerbose,
		quantity.TimeLeft,
		quantity.SpaceOff,
		[]string{
			"0h",
			"0h",
			"0h",
			"1h",
			"1h",
			"1h",
			"1h",
			"1h",
			"1h",
			"1h",
			"1h",
			"3h",
			"11h",
			"11h",
			"11h",
			"12h",
			"23h",
			"1d",
			"1d6h",
			"14d9h",
			"14d21h",
			"178d",
			"178d2h",
			"5y314d2h",
			"29y82d23h",
			"291y99d",
			"ages!",
			"ages!",
		},
	},
	{
		quantity.Day,
		quantity.Year,
		quantity.ShowVerbose,
		quantity.TimeLeft,
		quantity.SpaceOff,
		[]string{
			"0d",
			"0d",
			"0d",
			"1d",
			"1d",
			"1d",
			"1d",
			"1d",
			"1d",
			"1d",
			"1d",
			"1d",
			"1d",
			"1d",
			"1d",
			"1d",
			"1d",
			"1d",
			"2d",
			"15d",
			"15d",
			"178d",
			"179d",
			"5y314d",
			"29y83d",
			"291y99d",
			"ages!",
			"ages!",
		},
	},
	{
		quantity.Year,
		quantity.Year,
		quantity.ShowVerbose,
		quantity.TimeLeft,
		quantity.SpaceOff,
		[]string{
			"0y",
			"0y",
			"0y",
			"1y",
			"1y",
			"1y",
			"1y",
			"1y",
			"1y",
			"1y",
			"1y",
			"1y",
			"1y",
			"1y",
			"1y",
			"1y",
			"1y",
			"1y",
			"1y",
			"1y",
			"1y",
			"1y",
			"1y",
			"6y",
			"30y",
			"292y",
			"ages!",
			"ages!",
		},
	},
	{
		time.Second,
		time.Hour,
		quantity.ShowVerbose,
		quantity.TimeLeft,
		quantity.SpaceOff,
		[]string{
			"0s",
			"0s",
			"0s",
			"1s",
			"1s",
			"1s",
			"1s",
			"1s",
			"6s",
			"1m2s",
			"12m24s",
			"2h29m",
			"10h9m",
			"10h30m",
			"10h30m2s",
			"11h2m",
			"22h59m59s",
			"23h59m59s",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
		},
	},
	{
		time.Nanosecond,
		quantity.Year,
		quantity.ShowCompact,
		quantity.TimeLeft,
		quantity.SpaceOff,
		[]string{
			"0ns",
			"0ns",
			"0ns",
			"3ns",
			"36µs",
			"37µs",
			"421ms",
			"430ms",
			"6s",
			"1m2s",
			"12m24s",
			"2h29m",
			"10h9m",
			"10h30m",
			"10h31m",
			"11h2m",
			"23h",
			"1d",
			"1d6h",
			"14d9h",
			"14d21h",
			"178d",
			"179d",
			"6y",
			"30y",
			"292y",
			"ages!",
			"ages!",
		},
	},
	{
		time.Nanosecond,
		quantity.Day,
		quantity.ShowCompact,
		quantity.TimeLeft,
		quantity.SpaceOff,
		[]string{
			"0ns",
			"0ns",
			"0ns",
			"3ns",
			"36µs",
			"37µs",
			"421ms",
			"430ms",
			"6s",
			"1m2s",
			"12m24s",
			"2h29m",
			"10h9m",
			"10h30m",
			"10h31m",
			"11h2m",
			"23h",
			"1d",
			"1d6h",
			"14d9h",
			"14d21h",
			"178d",
			"179d",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
		},
	},
	{
		time.Nanosecond,
		time.Hour,
		quantity.ShowCompact,
		quantity.TimeLeft,
		quantity.SpaceOff,
		[]string{
			"0ns",
			"0ns",
			"0ns",
			"3ns",
			"36µs",
			"37µs",
			"421ms",
			"430ms",
			"6s",
			"1m2s",
			"12m24s",
			"2h29m",
			"10h9m",
			"10h30m",
			"10h31m",
			"11h2m",
			"23h",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
		},
	},
	{
		time.Nanosecond,
		time.Minute,
		quantity.ShowCompact,
		quantity.TimeLeft,
		quantity.SpaceOff,
		[]string{
			"0ns",
			"0ns",
			"0ns",
			"3ns",
			"36µs",
			"37µs",
			"421ms",
			"430ms",
			"6s",
			"1m2s",
			"12m24s",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
		},
	},
	{
		time.Nanosecond,
		time.Second,
		quantity.ShowCompact,
		quantity.TimeLeft,
		quantity.SpaceOff,
		[]string{
			"0ns",
			"0ns",
			"0ns",
			"3ns",
			"36µs",
			"37µs",
			"421ms",
			"430ms",
			"6s",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
		},
	},
	{
		time.Nanosecond,
		time.Nanosecond,
		quantity.ShowCompact,
		quantity.TimeLeft,
		quantity.SpaceOff,
		[]string{
			"0ns",
			"0ns",
			"0ns",
			"3ns",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
		},
	},
	{
		time.Microsecond,
		quantity.Year,
		quantity.ShowCompact,
		quantity.TimeLeft,
		quantity.SpaceOff,
		[]string{
			"0µs",
			"0µs",
			"0µs",
			"1µs",
			"36µs",
			"37µs",
			"421ms",
			"430ms",
			"6s",
			"1m2s",
			"12m24s",
			"2h29m",
			"10h9m",
			"10h30m",
			"10h31m",
			"11h2m",
			"23h",
			"1d",
			"1d6h",
			"14d9h",
			"14d21h",
			"178d",
			"179d",
			"6y",
			"30y",
			"292y",
			"ages!",
			"ages!",
		},
	},
	{
		time.Millisecond,
		quantity.Year,
		quantity.ShowCompact,
		quantity.TimeLeft,
		quantity.SpaceOff,
		[]string{
			"0ms",
			"0ms",
			"0ms",
			"1ms",
			"1ms",
			"1ms",
			"421ms",
			"430ms",
			"6s",
			"1m2s",
			"12m24s",
			"2h29m",
			"10h9m",
			"10h30m",
			"10h31m",
			"11h2m",
			"23h",
			"1d",
			"1d6h",
			"14d9h",
			"14d21h",
			"178d",
			"179d",
			"6y",
			"30y",
			"292y",
			"ages!",
			"ages!",
		},
	},
	{
		time.Second,
		quantity.Year,
		quantity.ShowCompact,
		quantity.TimeLeft,
		quantity.SpaceOff,
		[]string{
			"0s",
			"0s",
			"0s",
			"1s",
			"1s",
			"1s",
			"1s",
			"1s",
			"6s",
			"1m2s",
			"12m24s",
			"2h29m",
			"10h9m",
			"10h30m",
			"10h31m",
			"11h2m",
			"23h",
			"1d",
			"1d6h",
			"14d9h",
			"14d21h",
			"178d",
			"179d",
			"6y",
			"30y",
			"292y",
			"ages!",
			"ages!",
		},
	},
	{
		time.Minute,
		quantity.Year,
		quantity.ShowCompact,
		quantity.TimeLeft,
		quantity.SpaceOff,
		[]string{
			"0m",
			"0m",
			"0m",
			"1m",
			"1m",
			"1m",
			"1m",
			"1m",
			"1m",
			"2m",
			"13m",
			"2h29m",
			"10h9m",
			"10h30m",
			"10h31m",
			"11h2m",
			"23h",
			"1d",
			"1d6h",
			"14d9h",
			"14d21h",
			"178d",
			"179d",
			"6y",
			"30y",
			"292y",
			"ages!",
			"ages!",
		},
	},
	{
		time.Hour,
		quantity.Year,
		quantity.ShowCompact,
		quantity.TimeLeft,
		quantity.SpaceOff,
		[]string{
			"0h",
			"0h",
			"0h",
			"1h",
			"1h",
			"1h",
			"1h",
			"1h",
			"1h",
			"1h",
			"1h",
			"3h",
			"11h",
			"11h",
			"11h",
			"12h",
			"23h",
			"1d",
			"1d6h",
			"14d9h",
			"14d21h",
			"178d",
			"179d",
			"6y",
			"30y",
			"292y",
			"ages!",
			"ages!",
		},
	},
	{
		quantity.Day,
		quantity.Year,
		quantity.ShowCompact,
		quantity.TimeLeft,
		quantity.SpaceOff,
		[]string{
			"0d",
			"0d",
			"0d",
			"1d",
			"1d",
			"1d",
			"1d",
			"1d",
			"1d",
			"1d",
			"1d",
			"1d",
			"1d",
			"1d",
			"1d",
			"1d",
			"1d",
			"1d",
			"2d",
			"15d",
			"15d",
			"178d",
			"179d",
			"6y",
			"30y",
			"292y",
			"ages!",
			"ages!",
		},
	},
	{
		quantity.Year,
		quantity.Year,
		quantity.ShowCompact,
		quantity.TimeLeft,
		quantity.SpaceOff,
		[]string{
			"0y",
			"0y",
			"0y",
			"1y",
			"1y",
			"1y",
			"1y",
			"1y",
			"1y",
			"1y",
			"1y",
			"1y",
			"1y",
			"1y",
			"1y",
			"1y",
			"1y",
			"1y",
			"1y",
			"1y",
			"1y",
			"1y",
			"1y",
			"6y",
			"30y",
			"292y",
			"ages!",
			"ages!",
		},
	},
	{
		time.Second,
		time.Hour,
		quantity.ShowCompact,
		quantity.TimeLeft,
		quantity.SpaceOff,
		[]string{
			"0s",
			"0s",
			"0s",
			"1s",
			"1s",
			"1s",
			"1s",
			"1s",
			"6s",
			"1m2s",
			"12m24s",
			"2h29m",
			"10h9m",
			"10h30m",
			"10h31m",
			"11h2m",
			"23h",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
		},
	},
	{
		time.Hour,
		time.Hour,
		quantity.ShowVerbose,
		quantity.TimeLeft,
		quantity.SpaceOff,
		[]string{
			"0h",
			"0h",
			"0h",
			"1h",
			"1h",
			"1h",
			"1h",
			"1h",
			"1h",
			"1h",
			"1h",
			"3h",
			"11h",
			"11h",
			"11h",
			"12h",
			"23h",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
		},
	},
	{
		time.Hour,
		time.Hour,
		quantity.ShowVerbose,
		quantity.TimePassed,
		quantity.SpaceOff,
		[]string{
			"0h",
			"0h",
			"0h",
			"0h",
			"0h",
			"0h",
			"0h",
			"0h",
			"0h",
			"0h",
			"0h",
			"2h",
			"10h",
			"10h",
			"10h",
			"11h",
			"22h",
			"23h",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
		},
	},
	{
		time.Hour,
		time.Hour,
		quantity.ShowVerbose,
		quantity.TimeRounded,
		quantity.SpaceOff,
		[]string{
			"0h",
			"0h",
			"0h",
			"0h",
			"0h",
			"0h",
			"0h",
			"0h",
			"0h",
			"0h",
			"0h",
			"2h",
			"10h",
			"11h",
			"11h",
			"11h",
			"23h",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
			"ages!",
		},
	},
}

func (s *quantitySuite) TestGeneric(c *C) {
	for _, t := range tests {
		for i, dt := range dataset {
			output := fmt.Sprintf("%s", quantity.FormatDurationGeneric(dt,
				t.min,
				t.max,
				t.count,
				t.render,
				t.space))
			c.Check(output, Equals, t.results[i])
		}
	}
}

func (s *quantitySuite) TestPanic(c *C) {
	for _, dt := range dataset {
		c.Assert(func() {
			quantity.FormatDurationGeneric(dt,
				quantity.Year,
				time.Second,
				quantity.ShowVerbose,
				quantity.TimeLeft,
				true)
		}, PanicMatches, "Argument 'min' > 'max'. This is invalid")
	}

	c.Assert(func() {
		quantity.FormatDurationGeneric(1,
			time.Second,
			quantity.Year,
			quantity.ShowVerbose,
			5,
			true)
	}, PanicMatches, "Invalid rendering mode")
}
