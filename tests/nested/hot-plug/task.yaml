summary: create ubuntu classic image, install snapd and test hot plug feature

systems: [ubuntu-16.04-64, ubuntu-18.04-64]

prepare: |

    "$TESTSLIB"/prepare-restore.sh --prepare-suite
    "$TESTSLIB"/prepare-restore.sh --prepare-suite-each

    #shellcheck source=tests/lib/nested.sh
    . "$TESTSLIB/nested.sh"
    create_nested_classic_vm
    copy_remote "${GOHOME}"/snapd_*.deb
    execute_remote "sudo apt install -y ./snapd_*.deb"

restore: |
    #shellcheck source=tests/lib/nested.sh
    . "$TESTSLIB/nested.sh"
    destroy_nested_vm

    "$TESTSLIB"/prepare-restore.sh --restore-suite-each
    "$TESTSLIB"/prepare-restore.sh --restore-suite    

execute: |
    #shellcheck source=tests/lib/nested.sh
    . "$TESTSLIB/nested.sh"

    add_chardev my-chardev 9022
    add_usb_serial_device my-usb-serial my-chardev
    del_device my-usb-serial
    remove_chardev my-chardev
