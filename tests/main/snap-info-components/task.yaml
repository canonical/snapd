summary: Test that snap info command handles components as expected

details: |
  This test verifies that snap info prints components installed/available
  counts correctly for various scenarios:
  - Installed/Local (3/3) using test-snap-with-components
  - No components anywhere (Silence) using test-snapd-sh

prepare: |
  "${TESTSTOOLS}"/snaps-state install-local test-snap-with-components
  "${TESTSTOOLS}"/snaps-state install-local test-snapd-sh

restore: |
  snap remove --purge test-snap-with-components
  snap remove --purge test-snapd-sh

execute: |
  OUTPUT_INSTALLED=$(snap info test-snap-with-components)

  if echo "$OUTPUT_INSTALLED" | grep -q "components: 3/3"; then
    echo "PASS (Installed): Found expected 'components: 3/3'"
  else
    echo "FAIL (Installed): Expected 'components: 3/3', got:"
    echo "$OUTPUT_INSTALLED"
    exit 1
  fi

  OUTPUT_EMPTY=$(snap info test-snapd-sh)
  
  if echo "$OUTPUT_EMPTY" | grep -q "components:"; then
    echo "FAIL (No Components): Found 'components:' line but expected silence."
    echo "$OUTPUT_EMPTY"
    exit 1
  else
    echo "PASS (No Components): No 'components' line found."
  fi
