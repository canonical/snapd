summary: check the symlinks following the right track

environment:
    SNAP: test-snapd-validate-container-happy

prepare: |
    snap pack test-snapd-validate-container-happy
    snap install --dangerous test-snapd-validate-container-happy_1.0_all.snap

execute: |

    echo "Unleashing hell..."
    SNAP_MOUNT_DIR="$(os.paths snap-mount-dir)"
    tar -xvf $SNAP_MOUNT_DIR/$SNAP/hell/hell.tar

    SNAP_MOUNT_DIR="$(os.paths snap-mount-dir)"
    snap try "$SNAP"
    snap list "$SNAP"
    ls -l "$SNAP_MOUNT_DIR/$SNAP/hell | MATCH "bar -> baz -> qux"
    ls -l "$SNAP_MOUNT_DIR/$SNAP/hell | MATCH "foo -> bar -> baz"
    ls -l "$SNAP_MOUNT_DIR/$SNAP/hell | MATCH "foo -> bar -> qux"
    ls -l "$SNAP_MOUNT_DIR/$SNAP/hell | MATCH "foo -> baz -> qux"
