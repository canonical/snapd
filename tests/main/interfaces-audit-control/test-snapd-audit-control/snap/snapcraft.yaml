name: test-snapd-audit-control
base: core22
version: '1.0'
summary: Basic snap to test the audit_control interface
description: |
  A basic snap used to probe the audit_control capability, read
  /proc/self/loginuid and /proc/self/sessionid, and write /run/auditd.pid.

grade: devel # must be 'stable' to release into candidate/stable channels
confinement: devmode # use 'strict' once you have the right plugs and slots

parts:
  auditd:
    stage-packages:
      - auditd
    plugin: nil
  bins:
    plugin: dump
    source: .
    organize:
      audit-rate: bin/
      read-ids: bin/
      write-pid: bin/

apps:
  set-cap:
    command: bin/audit-rate
  read-ids:
    command: bin/read-ids
  write-pid:
    command: bin/write-pid
