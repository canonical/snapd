summary: smoke test for the retry test tool
execute: |
    # Retry runs the command that was passed as argument and returns the exit
    # code of that command.
    retry-tool true
    not retry-tool -n 1 false
    # If the command doesn't exist it is not re-tried multiple times.
    ( not retry-tool this-command-does-not-exist ) 2>&1 \
        | grep -F 'retry: cannot execute command this-command-does-not-exist: [Errno 2] No such file or directory'
    # On failure it tells us about it, showing progress.
    retry-tool -n 2 --wait 0.1 false 2>&1 | grep -F "retry: command false failed with code 1"
    retry-tool -n 2 --wait 0.1 false 2>&1 | grep -F "retry: next attempt in 0.1 second(s) (attempt 1 of 2)"
    retry-tool -n 2 --wait 0.1 false 2>&1 | grep -F "retry: command false keeps failing after 2 attempts"

