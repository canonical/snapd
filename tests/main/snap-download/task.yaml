summary: Check that snap download works
restore: |
    rm -f *.snap
execute: |
    verify_asserts() {
        fn="$1"
        grep "type: account-key" "$fn"
        grep "type: snap-declaration" "$fn"
        grep "type: snap-revision" "$fn"
    }
    echo "Snap download can download snaps"
    snap download hello-world
    ls hello-world_*.snap
    verify_asserts hello-world_*.assert

    echo "Snap download understand --edge"
    snap download --edge test-snapd-tools
    ls test-snapd-tools_*.snap
    verify_asserts test-snapd-tools_*.assert

    echo "Snap download downloads devmode snaps"
    snap download --beta classic
    ls classic_*.snap
    verify_asserts classic_*.assert

    echo "Snap download can download snaps as user"
    su -l -c "snap download hello-world" test
    ls /home/test/hello-world_*.snap
    verify_asserts /home/test/hello-world_*.assert