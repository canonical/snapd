summary: Ensure remove with unmounted base dir works

execute: |
    cp -ar "$TESTSLIB"/snaps/test-snapd-tools /tmp
    snap try /tmp/test-snapd-tools

    # simulate what happens if someone "snap try /tmp/something" and then
    # reboots: the dir is gone and nothing can be mounted anymore
    rm -rf /tmp/test-snapd-tools
    SNAP_MOUNT_DIR="$(os.paths snap-mount-dir)"
    umount "$SNAP_MOUNT_DIR/test-snapd-tools/x1"

    # ensure removal still works
    snap remove --purge test-snapd-tools