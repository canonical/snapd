summary: Checks for snap sideload reverts
prepare: |
  snapbuild $TESTSLIB/snaps/basic .
restore: |
  rm ./basic_1.0_all.snap
execute: |
  echo Installing sideloaded snap
  actual=$(snap install ./basic_1.0_all.snap)
  echo "$actual" | grep -Pzq "x1" || exit 1

  echo Installing new version of sideloaded snap
  actual=$(snap install ./basic_1.0_all.snap)
  echo "$actual" | grep -Pzq "x2" || exit 1

  echo Reverting to the previous version
  actual=$(snap revert basic)
  echo "$actual" | grep -Pzq "x1" || exit 1

