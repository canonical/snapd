summary: Verify sandbox is correctly reported

execute: |
    case "$SPREAD_SYSTEM" in
    ubuntu-*)
        snap debug sandbox | MATCH "apparmor: .+"
        ;;
    fedora-*|debian-*|opensuse-*)
        # Fedora because it uses SELinux
        # Debian and openSUSE because partial apparmor is not enabled
        snap debug sandbox | MATCH -v "apparmor: .+"
        ;;
    esac
    snap debug sandbox | MATCH "dbus: .+"
    snap debug sandbox | MATCH "kmod: .+"
    snap debug sandbox | MATCH "mount: .+"
    snap debug sandbox | MATCH "seccomp: .+"
    snap debug sandbox | MATCH "udev: .+"
