summary: Ensure that XDG_RUNTIME_DIR is created

details: |
    Ensure that the XDG_RUNTIME_DIR is created when a snap is launched.

prepare: |
    echo Testing XDG_RUNTIME_DIR
    "$TESTSTOOLS"/snaps-state install-local test-snapd-xdg-dir
    rm -f /run/user/0/snap.test-snapd-xdg-dir

execute: |
    test ! -e /run/user/0/snap.test-snapd-xdg-dir
    #   xdgtest returns 255 if the folder doesn't exist,
    #   making the task fail in that case.
    snap run test-snapd-xdg-dir
    test -d /run/user/0/snap.test-snapd-xdg-dir
    # re-run the test to ensure that it doesn't fail if the folder already exists
    snap run test-snapd-xdg-dir
