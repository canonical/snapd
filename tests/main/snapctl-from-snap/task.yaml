summary: Check that `snapctl` can be run from the snap

prepare: |
    snapbuild $TESTSLIB/snaps/snapctl-from-snap .
    snap install --dangerous snapctl-from-snap_1.0_all.snap

restore: |
    rm snapctl-from-snap_1.0_all.snap

execute: |
    echo "Verify that snapctl get can be executed by the app and shows the value set by configure hook"
    OUTPUT=$(/snap/bin/snapctl-from-snap.app1)
    EXPECTED="bar"
    if [ "$OUTPUT" != $EXPECTED ]; then
        echo "Expected '$EXPECTED', got '$OUTPUT'"
    fi

    echo "Verify that snapctl set can modify configuration values"
    OUTPUT=$(/snap/bin/snapctl-from-snap.app2)
    EXPECTED="123"
    if [ "$OUTPUT" != $EXPECTED ]; then
        echo "Expected '$EXPECTED', got '$OUTPUT'"
    fi
