#!/usr/bin/env any-python
import argparse
import subprocess
import sys
import time


def run_command(commands, max_attempts, sleep_time):

    for _ in range(0, max_attempts):
        try:
            subprocess.call(commands)
            return
        except:
            time.sleep(sleep_time)

    sys.exit(1)


def main():
    parser = argparse.ArgumentParser()
    parser.add_argument(
        "--max-attempts",
        type=int,
        default=20,
        help="Number of attempts the command will be executed")
    parser.add_argument(
        "--sleep-time",
        type=float,
        default=.5,
        help="Time to wait between the retries")
    args, commands = parser.parse_known_args()

    run_command(commands, args.max_attempts, args.sleep_time)


if __name__ == "__main__":
    main()
